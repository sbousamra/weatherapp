<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
    <script>
        function handleSearchRequest() {
            var searchInput = document.getElementById("search-bar").value;
            $.ajax({
                type: "GET",
                url: location.origin + "/weather/" + searchInput,
                cache: false,
                dataType: "json",
                success: function(data) {
                    <!--$("#search-results").html(data);-->
                    var locationDetails = "<h2>" + data.location.city + " - " + data.location.country + " - " + data.location.region + "</h2>";
                    var forecastDetails = getForecastHtml(data.forecast);
                    $("#results #location").html(locationDetails);
                    $("#results #forecast").html(forecastDetails);
                },
                error: function(request, error) {
                    document.getElementById("search-results").innerHTML = "Not a valid location";
                }
            });
        }

        function getForecastHtml(forecastJson) {
            console.log(forecastJson);
            var forecastFormatting = forecastJson.map(function(result) {
                return "Day: " + result.day + "</br>"
                 + "Date: " + result.date + "</br>"
                 + handleImage(result) + "</br>"
                 + "High: " + result.high
                 + ", Low: " + result.low
                 + ", Conditions: " + result.text
            })
            return "<h3>" + forecastFormatting[0] + "<br/>" + "<hr>" + forecastFormatting.slice(1, forecastFormatting.length).join("<br/>") + "</h3>"
        }

        function handleImage(result) {
            if (result.text == "Sunny") {
                return "<img src=http://i.imgur.com/ekngZ2B.jpg alt=sunny height=100 width=100>"
            } else if (result.text == "Thunderstorms") {
                return "<img src=http://i.imgur.com/3K5OXfF.jpg alt=thunderstorms height=100 width=100>"
            } else if (result.text == "Severe Thunderstorms") {
                return "<img src=http://i.imgur.com/Hma2Pef.jpg alt=severethunderstorms height=100 width=100>"
            } else if (result.text == "Snow") {
                return "<img src=http://i.imgur.com/GepGojL.jpg alt=snow height=100 width=100>"
            } else if (result.text == "Cloudy") {
                return "<img src=http://i.imgur.com/9jpKwrw.jpg alt=cloudy height=100 width=100>"
            } else if (result.text == "Showers") {
                return "<img src=http://i.imgur.com/hZk0FcA.jpg alt=showers height=100 width=100>"
            } else {
                return "<img src=http://i3.kym-cdn.com/photos/images/newsfeed/000/925/494/218.png_large alt=notsure height=100 width=100>"
            }
        }

    </script>
</head>
<body>

    <h1>Welcome to Bass's Weather App</h1>
    <p id="title">
        This application will allow your to find all the information you could want about the weather in a location of your choice.
        Just enter in your location in the search bar and enjoy!
    </p>

    <p>
        Enter the location you'd like to find the weather for.
    </p>

    <input type="search" id="search-bar" placeholder="Search for your location">

    <button onclick="handleSearchRequest()">Search</button>

    <pre id="search-results"></pre>

    <!--<div id="fake-results">-->
        <!--<hr>-->

        <!--<h1>Sydney - Australia - NSW</h1>-->
        <!--<h3>Forecast</h3>-->
        <!--<h4>Monday</h4>-->
        <!--<p>Thunderstorms - Low: 29 - High: 35</p>-->
        <!--<h4>Tuesday</h4>-->
        <!--<p>Thunderstorms - Low: 29 - High: 35</p>-->
        <!--<h4>Wednesday</h4>-->
        <!--<p>Thunderstorms - Low: 29 - High: 35</p>-->
        <!--<h4>Thursday</h4>-->
        <!--<p>Thunderstorms - Low: 29 - High: 35</p>-->
        <!--<h4>Friday</h4>-->
        <!--<p>Thunderstorms - Low: 29 - High: 35</p>-->
        <!--<h4>Saturday</h4>-->
        <!--<p>Thunderstorms - Low: 29 - High: 35</p>-->
        <!--<h4>Sunday</h4>-->
        <!--<p>Thunderstorms - Low: 29 - High: 35</p>-->
    <!--</div>-->

    <div id="results">
        <div id="location">

        </div>

        <div id="forecast">

        </div>
    </div>

</body>
</html>