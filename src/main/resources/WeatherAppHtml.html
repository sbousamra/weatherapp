<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
    <script>
        function handleSearchRequest() {
            var searchInput = document.getElementById("search-bar").value;
            $.ajax({
                type: "GET",
                url: location.origin + "/weather/" + searchInput,
                cache: false,
                dataType: "json",
                success: function(data) {
                    var locationDetails = "<h2>" + data.location.city + " - " + data.location.country + " - " + data.location.region + "</h2>";
                    var forecastDetails = getForecastHtml(data.forecast);
                    $("#search-error").empty()
                    $("#results #location").html(locationDetails);
                    $("#results #forecast").html(forecastDetails);
                },
                error: function(request, error) {
                    $("#results #location").empty()
                    $("#results #forecast").empty()
                    $("#search-error").html("Not a valid location");
                }
            });
        }

        function getForecastHtml(forecastJson) {
            console.log(forecastJson);
            var forecastFormatting = forecastJson.map(function(result) {
                var imageUrl = handleImage(result)
                return "Day: " + result.day + "</br>"
                 + "Date: " + result.date + "</br>"
                 + "<img src=" + imageUrl + " height=100 width=100>" + "</br>"
                 + "High: " + result.high
                 + ", Low: " + result.low
                 + ", Conditions: " + result.text + "<br/>"
            })
            return "<h3>" + forecastFormatting[0] + "<br/>" + "<hr>" + forecastFormatting.slice(1, forecastFormatting.length).join("<br/>") + "</h3>"
        }

        function handleImage(result) {
            if (result.text == "Tornado") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Tropical Storm") {
                return "http://i.imgur.com/3K5OXfF.jpg"
            } else if (result.text == "Hurricane") {
                return "http://i.imgur.com/3K5OXfF.jpg"
            } else if (result.text == "Severe Thunderstorms") {
                return "http://i.imgur.com/Hma2Pef.jpg"
            } else if (result.text == "Thunderstorms") {
                return "http://i.imgur.com/3K5OXfF.jpg"
            } else if (result.text == "Mixed Rain And Snow") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Mixed Rain And Sleet") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Mixed Snow And Sleet") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Freezing Drizzle") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Drizzle") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Freezing Rain") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Showers") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Snow Flurries") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Light Snow Showers") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Blowing Snow") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Snow") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Hail") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Sleet") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Dust") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Foggy") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Haze") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Smoky") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Blustery") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Windy") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Cold") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Dust") {
                return "http://i.imgur.com/MpDkUel.jpg"
            } else if (result.text == "Cloudy") {
                return "http://i.imgur.com/9jpKwrw.jpg"
            } else if (result.text == "Mostly Cloudy (Night)") {
                return "http://i.imgur.com/W9SmW3N.jpg"
            } else if (result.text == "Mostly Cloudy (Day)") {
                return "http://i.imgur.com/9jpKwrw.jpg"
            } else if (result.text == "Partly Cloudy (Night)") {
                return "http://i.imgur.com/W9SmW3N.jpg"
            } else if (result.text == "Partly Cloudy (Day)") {
                return "http://i.imgur.com/9jpKwrw.jpg"
            } else if (result.text == "Clear (Night)") {
                return "http://i.imgur.com/ekngZ2B.jpg"
            } else if (result.text == "Sunny") {
                return "http://i.imgur.com/ekngZ2B.jpg"
            } else if (result.text == "Fair (Night)") {
                return "http://i.imgur.com/W9SmW3N.jpg"
            } else if (result.text == "Fair (Day)") {
                return "http://i.imgur.com/9jpKwrw.jpg"
            } else if (result.text == "Mixed Rain And Hail") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Hot") {
                return "http://i.imgur.com/ekngZ2B.jpg"
            } else if (result.text == "Isolated Thunderstorms") {
                return "http://i.imgur.com/3K5OXfF.jpg"
            } else if (result.text == "Scattered Thunderstorms") {
                return "http://i.imgur.com/3K5OXfF.jpg"
            } else if (result.text == "Scattered Showers") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Heavy Snow") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Partly Cloudy") {
                return "http://i.imgur.com/9jpKwrw.jpg"
            } else if (result.text == "Thundershowers") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else if (result.text == "Snow Showers") {
                return "http://i.imgur.com/GepGojL.jpg"
            } else if (result.text == "Isolated Thundershowers") {
                return "http://i.imgur.com/hZk0FcA.jpg"
            } else {
                return "http://i.imgur.com/MpDkUel.jpg"
            }
        }
    </script>
</head>
<body>

    <h1>Welcome to Bass's Weather App</h1>
    <p id="title">
        This application will allow your to find all the information you could want about the weather in a location of your choice.
        Just enter in your location in the search bar and enjoy!
    </p>

    <input type="search" id="search-bar" placeholder="Search for your location">

    <button onclick="handleSearchRequest()">Search</button>

    <div id="search-error"></div>

    <div id="results">
        <div id="location">

        </div>

        <div id="forecast">

        </div>
    </div>

</body>
</html>